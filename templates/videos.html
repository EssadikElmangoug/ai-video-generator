{% extends "base.html" %}

{% block title %}Generated Videos - Shorts AI Agent{% endblock %}

{% block content %}
<div class="hero-section">
    <div class="container text-center">
        <h1 class="display-4 mb-3">Generated Videos</h1>
        <p class="lead">Browse, watch, and download your AI-generated videos</p>
    </div>
</div>

<div class="container my-5">
    {% if videos %}
        <div class="row">
            {% for video in videos %}
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 video-card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <h6 class="mb-0">Video {{ video.folder }}</h6>
                            <span class="badge">{{ "%.1f"|format(video.size / 1024 / 1024) }} MB</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Video Player -->
                        <div class="video-player mb-3">
                            <video 
                                controls 
                                class="w-100" 
                                preload="metadata">
                                <source src="/video/{{ video.path }}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        
                        <!-- Video Info -->
                        <div class="row text-center">
                            <div class="col-6">
                                <small class="text-muted">{{ video.created }}</small>
                            </div>
                            <div class="col-6">
                                <small class="text-muted">{{ "%.1f"|format(video.size / 1024 / 1024) }} MB</small>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <div class="d-grid gap-2">
                            <a href="/download/{{ video.path }}" class="btn btn-success btn-sm">
                                Download Video
                            </a>
                            <button class="btn btn-outline-primary btn-sm" onclick="shareVideo('{{ video.path }}')">
                                Share
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="text-center py-5">
            <div class="feature-icon mx-auto mb-4">
                <i class="fas fa-video"></i>
            </div>
            <h3 class="text-muted mb-3">No Videos Generated Yet</h3>
            <p class="text-muted mb-4">Start by generating your first AI video!</p>
            <a href="{{ url_for('index') }}" class="btn btn-primary btn-lg">
                Generate Video
            </a>
        </div>
    {% endif %}
</div>

<!-- Instructions Section -->
<div class="container my-5">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">How It Works</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <h6>Script Generation</h6>
                            <p class="small text-muted">AI creates a compelling script with detailed scene descriptions</p>
                            
                            <h6>Image Creation</h6>
                            <p class="small text-muted">Generate character-consistent images for each scene</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6>Audio Generation</h6>
                            <p class="small text-muted">Create natural-sounding voiceovers for your script</p>
                            
                            <h6>Video Assembly</h6>
                            <p class="small text-muted">Combine everything into a final MP4 video</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function shareVideo(videoPath) {
    if (navigator.share) {
        navigator.share({
            title: 'AI Generated Video',
            text: 'Check out this AI-generated video!',
            url: window.location.origin + '/video/' + videoPath
        });
    } else {
        // Fallback: copy to clipboard
        const url = window.location.origin + '/video/' + videoPath;
        navigator.clipboard.writeText(url).then(() => {
            showNotification('Video link copied to clipboard!', 'success');
        });
    }
}

function showNotification(message, type) {
    const alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
    const icon = type === 'success' ? 'fa-check-circle' : 'fa-exclamation-triangle';
    
    const notification = $(`
        <div class="alert ${alertClass} alert-dismissible fade show position-fixed" 
             style="top: 20px; right: 20px; z-index: 9999; min-width: 300px;">
            <i class="fas ${icon} me-2"></i>${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    `);
    
    $('body').append(notification);
    
    setTimeout(() => {
        notification.alert('close');
    }, 5000);
}
</script>
{% endblock %}
